name: reusable-security-rustsec

on:
  workflow_call:

permissions:
  contents: read

env:
  CARGO_TERM_COLOR: always

jobs:
  cargo_audit:
    name: cargo audit (RustSec)
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Rust toolchain
        uses: dtolnay/rust-toolchain@1.92.0

      - name: Cargo audit
        uses: actions-rust-lang/audit@v1
        with:
          # Keep PR checks non-invasive: no automatic GitHub issue creation.
          createIssues: false
          # Use repo config (.cargo/audit.toml) and Cargo.lock by default.
          TOKEN: ${{ github.token }}
